#!/usr/bin/perl
use strict;
use warnings;

open I, "<", "indivID_haploID.txt";
<I>;
my %ind;
while (<I>) {
	chomp;
	my @a = split /\t/;
	if ($a[4] eq "n/a") {
		next;
	} else {
		if ($ind{$a[3]}) {
			warn $a[0] if $ind{$a[3]}[0] ne $a[4];
		} else {
			$ind{$a[3]}[0] = $a[4];
			$ind{$a[3]}[1] = $a[2];
			$ind{$a[3]}[2] = $a[5];
		}
	}
}
close I;

my %seq = qw /
CR_Uth25	ACCATTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCCATGTACTGTACCATCACAGTATGTTCTCGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATACTGTGCTTGGCTTTACATGAGGACTTACGTTCCGAAAAGTTTATTTCAGGCGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth26	ACAATTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCCATGTACTGTACCATCACAGTATGTTCTCGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATACTGTGCTTGGCTTTACATGAGGACTTACGTTCCGAAAAGTTTATTTCAGGCGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth29	ACAGTTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCCATGTACTGTACCATCACAGTATGTTCTCGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATACTGTGCTTGGCTTTACATGAGGACTTACGTTCCGAAAAGTTTATTTCAGGCGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth30	ACAATTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCCATGTACTGTACCATCACAGTATGTTCTCGAATACTTTCTTCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATACTGTGCTTGGCTTTACATGAGGACTTACGTTCCGAAAAGTTTATTTCAGGCGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth31	ACAATTATTTCACTTTATGTCTTATTTATTTCATATATATCATTCCATGTACTGTACCATCACAGTATGTTCTCGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATACTGTGCTTGGCTTTACATGAGGACTTACGTTCCGAAAAGTTTATTTCAGGCGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth46	ACCATTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCTATGTACTGTACCATCACAGTATGTTCTCGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATACTGTGCTTGGCTTTACATGAGGACTTACGTTCCGAAAAGTTTATTTCAGGCGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth47	ACCATTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCCATGTACTGTACCATCACAGTATGTTCTCGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATACTGTGCTTGGTTTTACATGAGGACTTACGTTCCGAAAAGTTTATTTCAGGCGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth48	ACCATTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCCATGTACTGTACCATCACAGTATGTTCTCGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATACTGTGCTTGGCTTTACATGAGGACTTACGTTCCGAAAAGTTTATTTCAAGCGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth49	ACCATTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCCATGTACTGTACCATCACAGTATGTTCTCGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATACTATGCTTGGCTTTACATGAGGACTTACGTTCCGAAAAGTTTATTTCAGGCGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth50	ACCATTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCCATGTACTGTACCATCACAGTATGTTCTCGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATACTGTGCTTGGCTTTACATGAGGACTTACGTTCCGAAAGGTTTATTTCAGGCGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth51	ACCATTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCCATGTACTGTACCATCACAGTATGTTCTCGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATATTGTGCTTGGCTTTACATGAGGACTTACGTTCCGAAAAGTTTATTTCAGGTGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth52	ACCATTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCCATGTACTGTACCATCACAGTATGTTCTCGAATACTTTCTCCTTTATTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATACTGTGCTTGGCTTTACATGAGGACTTACGTTCCGAAAAGTTTATTTCAGGCGTATAGTCTGCAAGCATGTATTTCACT
CR_Uth53	ACCATTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCCATGTACTGTACCATCACAGTATGTTCTCGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATATTGTGCTTGGCTTTACATGAGGACTTACGTTCCGAAAAGTTTATTTCAGGCGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth54	ACTATTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCCATGTACTGTACCATCATAGTATGTTCTCGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATACTGTGCTTGGCTTTACATGAGGACTTACGTTCCGAAAAGTTTATTTCAGGCGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth55	ACCATTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCCATGTACTGTACCATCACAGTATGTTCTTGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATACTGTGCTTGGTTTTACATGAGGACTTACGTTCTAAAAAGCTTGTTTTAGGTGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth56	ACCATTATTTCACTTTATGTCCTATTTATTTCATATATATCATCCCATGTACTGTACCATCACAGTATGTTCTTGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATATTGTGCTTGGCTTTACATGAGGACTTACGTTCCAAAAAGCTTGTTTTGGGTGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth57	ACCATTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCCATGTACTGTACCATCACAGTATGTTCTCGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATACTGTGCTTGGTTTTACATGAGGACTTACGTTCCGGAAAGTTTATTTCAGGCGTATAGTCTGTAAGCATGTATTTCACT
CR_Uth58	ACCATTATTTCACTTTATGTCCTATTTATTTCATATATATCATTCCATGTACTGTACCATCACAGTATGTTCTCGAATACTTTCTCCTTTGTTTTCCCCCTATGTATATCGTGCATTAATGGCGTGCCCCATGCATATAAGCATGTACATACTGTGCTTGGCTTTACATGAGGACTTACGTTCCGAAAAGTTTATTTCAGGTGTATAGTCTGTAAGCATGTATTTCACT
/;

open O, ">", "CR_indiv.fasta";
foreach (sort keys %ind) {
	print O ">${_}_$ind{$_}[0]_$ind{$_}[1]\n$seq{$ind{$_}[2]}\n";
}
close O;
